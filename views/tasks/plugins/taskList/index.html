<div class="task-list-container" v-show="hasTasksData" role="region" aria-label="任务列表">
    <div class="task-list-content">
        <!-- 加载状态 -->
        <div v-if="loading" class="task-loading-state" role="status" aria-live="polite">
            <i class="fas fa-spinner" aria-hidden="true"></i>
            <span>正在加载任务数据...</span>
        </div>
        
        <!-- 错误状态 -->
        <div v-else-if="error" class="task-error-state" role="alert" aria-live="assertive">
            <i class="fas fa-exclamation-triangle" aria-hidden="true"></i>
            <span>加载失败</span>
            <p>{{ error }}</p>
            <button @click="handleLoadTasksData" class="task-retry-btn" aria-label="重新加载任务数据">
                <i class="fas fa-refresh" aria-hidden="true"></i>
                重新加载
            </button>
        </div>
        
        <!-- 空状态 -->
        <div v-else-if="searchResults.length === 0" class="task-empty-state" role="status" aria-live="polite">
            <i class="fas fa-tasks" aria-hidden="true"></i>
            <span v-if="searchQuery">未找到匹配 "{{ searchQuery }}" 的任务</span>
            <span v-else>暂无任务数据</span>
        </div>
        
        <!-- 任务列表 -->
        <div v-else class="task-grid" role="list" aria-label="任务列表">
            <article 
                v-for="(task, index) in searchResults" 
                :key="task.title"
                @touchstart="startLongPress(task, $event)"
                @touchend="endLongPress"
                @touchcancel="endLongPress"
                @mousedown="startLongPress(task, $event)"
                @mouseup="endLongPress"
                @mouseleave="endLongPress"
                @click="handleTaskClick(task, $event)"
                :class="['task-item', { 
                    active: clickedItems.has(task.title),
                    clicked: clickedItems.has(task.title),
                    'selected': isTaskSelected(task)
                }]"
                :title="getTaskTitle(task)"
                role="listitem"
                tabindex="0"
                @keydown.enter="handleTaskClick(task, $event)"
                @keydown.space="handleTaskClick(task, $event)"
                :aria-label="`任务 ${index + 1}: ${task.title}`"
                :aria-describedby="`task-${index}-description`"
            >
                <header class="task-header">
                    <div class="task-header-content">
                        <h3 class="task-title" :id="`task-${index}-title`">{{ task.title }}</h3>
                    </div>
                </header>
                
                <div class="task-description" :id="`task-${index}-description`">
                    {{ task.description }}
                </div>
                
                <div class="task-input-output" aria-label="任务输入输出信息">
                    <div class="task-input">
                        <h5>
                            <i class="fas fa-arrow-down" aria-hidden="true"></i>
                            输入
                        </h5>
                        <p>{{ task.input }}</p>
                    </div>
                    <div class="task-output">
                        <h5>
                            <i class="fas fa-arrow-up" aria-hidden="true"></i>
                            输出
                        </h5>
                        <p>{{ task.output }}</p>
                    </div>
                </div>
                <div class="task-meta-row">
                  <div class="task-progress" v-if="getTaskProgress(task).total > 0">
                      <i class="fas fa-tasks" aria-hidden="true"></i>
                      <span class="progress-text">{{ getTaskProgress(task).completed }}/{{ getTaskProgress(task).total }}</span>
                      <div class="progress-bar">
                          <div 
                              class="progress-fill" 
                              :style="{ width: getTaskProgress(task).percentage + '%' }"
                              :aria-label="`任务进度 ${getTaskProgress(task).percentage}%`"
                          ></div>
                      </div>
                  </div>

                  <time class="task-time" :datetime="task.time" aria-label="任务时间">
                    <i class="fas fa-clock" aria-hidden="true"></i>
                    <span>{{ formatTaskTime(task.time) }}</span>
                </time>
              </div>
            </article>
        </div>
    </div>
</div> 
