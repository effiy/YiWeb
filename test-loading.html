<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Loading 测试页面</title>
    <link rel="stylesheet" href="css/apiLoading.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 200vh; /* 创建长页面用于测试滚动 */
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .test-button {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .scroll-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="scroll-indicator" id="scroll-indicator">
        滚动位置: 0px
    </div>
    
    <div class="test-section">
        <h1>API Loading 显示测试</h1>
        <p>这个页面用于测试 api-loading-content 的显示问题是否已修复。</p>
        
        <h2>测试按钮</h2>
        <button class="test-button" onclick="testBasicLoading()">基础加载测试</button>
        <button class="test-button" onclick="testProgressBar()">进度条测试</button>
        <button class="test-button" onclick="testPositions()">位置测试</button>
        <button class="test-button" onclick="testScrollHandling()">滚动处理测试</button>
        <button class="test-button" onclick="testContentVisibility()">内容显示测试</button>
        <button class="test-button" onclick="testPositionOptimization()">位置优化测试</button>
        <button class="test-button" onclick="scrollToBottom()">滚动到底部</button>
        <button class="test-button" onclick="scrollToTop()">滚动到顶部</button>
    </div>
    
    <!-- 创建长内容用于测试滚动 -->
    <div class="test-section">
        <h2>测试区域 1</h2>
        <p>这是第一个测试区域，用于创建页面高度。</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 2</h2>
        <p>这是第二个测试区域，继续增加页面高度。</p>
        <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 3</h2>
        <p>这是第三个测试区域，用于测试在页面中间位置的显示。</p>
        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 4</h2>
        <p>这是第四个测试区域，继续增加页面高度。</p>
        <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 5</h2>
        <p>这是第五个测试区域，用于测试在页面底部附近的显示。</p>
        <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 6</h2>
        <p>这是第六个测试区域，继续增加页面高度。</p>
        <p>Totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 7</h2>
        <p>这是第七个测试区域，用于测试在页面底部的显示。</p>
        <p>Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 8</h2>
        <p>这是第八个测试区域，继续增加页面高度。</p>
        <p>Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 9</h2>
        <p>这是第九个测试区域，用于测试在页面最底部的显示。</p>
        <p>Sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.</p>
    </div>
    
    <div class="test-section">
        <h2>测试区域 10</h2>
        <p>这是第十个测试区域，页面底部。</p>
        <p>Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam.</p>
    </div>

    <script type="module">
        import { 
            apiLoading, 
            showApiLoading, 
            hideApiLoading, 
            updateApiProgress, 
            testProgressBar, 
            testPositions, 
            testScrollHandling, 
            testContentVisibility,
            testPositionOptimization
        } from './utils/apiLoading.js';
        
        // 暴露到全局作用域
        window.apiLoading = apiLoading;
        window.showApiLoading = showApiLoading;
        window.hideApiLoading = hideApiLoading;
        window.updateApiProgress = updateApiProgress;
        window.testProgressBar = testProgressBar;
        window.testPositions = testPositions;
        window.testScrollHandling = testScrollHandling;
        window.testContentVisibility = testContentVisibility;
        window.testPositionOptimization = testPositionOptimization;
        
        // 更新滚动指示器
        function updateScrollIndicator() {
            const indicator = document.getElementById('scroll-indicator');
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            indicator.textContent = `滚动位置: ${scrollTop}px`;
        }
        
        // 监听滚动事件
        window.addEventListener('scroll', updateScrollIndicator);
        updateScrollIndicator();
        
        // 基础加载测试
        window.testBasicLoading = () => {
            const requestId = apiLoading.generateRequestId();
            showApiLoading(requestId, {
                message: '基础加载测试',
                showProgress: false
            });
            
            setTimeout(() => {
                hideApiLoading(requestId);
            }, 3000);
        };
        
        // 滚动到底部
        window.scrollToBottom = () => {
            window.scrollTo(0, document.body.scrollHeight);
        };
        
        // 滚动到顶部
        window.scrollToTop = () => {
            window.scrollTo(0, 0);
        };
        
        console.log('API Loading 测试页面已加载');
        console.log('可用的测试函数:');
        console.log('- testBasicLoading()');
        console.log('- testProgressBar()');
        console.log('- testPositions()');
        console.log('- testScrollHandling()');
        console.log('- testContentVisibility()');
        console.log('- testPositionOptimization()');
        console.log('- scrollToBottom()');
        console.log('- scrollToTop()');
    </script>
</body>
</html> 