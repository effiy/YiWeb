<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YiWeb - ‰ª£Á†ÅÂÆ°Êü•</title>
    <link rel="stylesheet" href="../../views/aicr/index.css">
    <link rel="stylesheet" href="../../views/aicr/components/sessionList/index.css">
    <link rel="stylesheet" href="../../libs/font-awesome/css/all.min.css">
    <script src="../../libs/vue/vue.global.js"></script>
    <!-- Highlight.js for Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- Marked.js for Markdown rendering -->
    <script src="../../libs/marked/marked.min.js"></script>
    <!-- Mermaid.js for diagram rendering -->
    <script src="../../libs/mermaid/mermaid.min.js"></script>
</head>
<body>
    <div id="app">
      <!-- È°∂ÈÉ®ÊêúÁ¥¢‰∏éÂàÜÁ±ªÂå∫Âüü -->
      <header class="header-row" role="banner">
        <section class="search-row">
            <form class="search-box" role="search" aria-label="‰ª£Á†ÅÂÆ°Êü•ÊêúÁ¥¢">
                <span class="search-logo" aria-hidden="true" @click="openLink('/index.html')">
                    <i class="fas fa-globe" aria-label="‰ª£Á†ÅÂÆ°Êü•ÂõæÊ†á"></i>
                </span>
                <div class="search-input-wrapper">
                    <label for="messageInput" class="visually-hidden">ÊêúÁ¥¢ËæìÂÖ•Ê°Ü</label>
                    <textarea 
                        id="messageInput" 
                        placeholder="ÊêúÁ¥¢ÁΩëÁ´ô„ÄÅÊ†áÁ≠æÊàñÊèèËø∞..." 
                        rows="1" 
                        maxlength="2000"
                        aria-label="ÊêúÁ¥¢ËæìÂÖ•Ê°Ü"
                        aria-describedby="category-filters"
                        autocomplete="off"
                        spellcheck="false"
                        @keydown="handleMessageInput"
                        @compositionstart="handleCompositionStart"
                        @compositionend="handleCompositionEnd"
                        @input="handleSearchInput"></textarea>
                    
                    <!-- Ê∏ÖÈô§ÊêúÁ¥¢ÊåâÈíÆ -->
                    <div class="search-clear" v-if="searchQueryValue">
                        <button 
                            type="button"
                            @click.prevent="clearSearch"
                            class="clear-search-btn"
                            title="Ê∏ÖÈô§ÊêúÁ¥¢"
                            aria-label="Ê∏ÖÈô§ÊêúÁ¥¢ÂÜÖÂÆπ"
                        >
                            <i class="fas fa-times" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </form>
            
            <!-- È°πÁõÆÈÄâÊã©Âô® -->
            <nav class="category-filters" id="category-filters" role="toolbar" aria-label="È°πÁõÆËøáÊª§Âô®">
                <ul class="filter-buttons">

                </ul>
            </nav>
            
        </section>
        </header>
        <main class="aicr-main">
            <!-- ‰æßËæπÊ†èÂ±ïÂºÄÊääÊâã (Êî∂Ëµ∑Êó∂ÊòæÁ§∫) -->
            <button 
                type="button"
                class="sidebar-expand-handle"
                v-show="sidebarCollapsed"
                @click="toggleSidebar"
                aria-label="Â±ïÂºÄ‰æßËæπÊ†è"
                title="Â±ïÂºÄ‰æßËæπÊ†è">
                <i class="fas fa-chevron-right" aria-hidden="true"></i>
                <span class="label">Â±ïÂºÄ</span>
            </button>

            <!-- ‰æßËæπÊ†èÊî∂Ëµ∑ÊåâÈíÆ (Â±ïÂºÄÊó∂ÊòæÁ§∫ÔºåË∑üÈöè‰æßËæπÊ†èÂÆΩÂ∫¶) -->
            <div 
                class="file-tree-toggle" 
                v-show="!sidebarCollapsed"
                @click="toggleSidebar"
                title="Êî∂Ëµ∑‰æßËæπÊ†è"
                :style="{ left: ((viewMode === 'tree' ? sidebarWidth : sessionSidebarWidth) - 14) + 'px', right: 'auto' }">
                <i class="fas fa-chevron-left"></i>
            </div>

            <aside class="aicr-sidebar" aria-label="‰æßËæπÊ†è" v-show="!sidebarCollapsed" :style="{ width: (viewMode === 'tree' ? sidebarWidth : sessionSidebarWidth) + 'px' }">
                <div class="sidebar-scroll-container">
                    <!-- ÂÖ±‰∫´ÊêúÁ¥¢ÂÆπÂô®Ôºà‰∏§ÁßçËßÜÂõæÊ®°ÂºèÂÖ±Áî®Ôºâ -->
                    <div v-if="!sidebarCollapsed" class="file-tree-header-container">

                    
                        <!-- ÊêúÁ¥¢ËæìÂÖ•Ê°ÜÂíåËßÜÂõæÂàáÊç¢ -->
                        <div class="file-tree-search-container">
                            <div class="file-tree-search-wrapper">
                                <span class="file-tree-search-icon">üîç</span>
                                <input
                                    type="text"
                                    class="file-tree-search-input"
                                    :value="viewMode === 'tree' ? (searchQuery || '') : (sessionSearchQuery || '')"
                                    @input="viewMode === 'tree' ? handleSearchInput($event) : handleSessionSearchChange($event.target.value)"
                                    @keydown.esc="viewMode === 'tree' ? clearSearch() : handleSessionSearchChange('')"
                                    :placeholder="viewMode === 'tree' ? 'ÊêúÁ¥¢Êñá‰ª∂...' : 'ÊêúÁ¥¢‰ºöËØù...'"
                                    aria-label="ÊêúÁ¥¢"
                                />
                                <button
                                    v-if="(viewMode === 'tree' && searchQuery) || (viewMode === 'tags' && sessionSearchQuery)"
                                    class="file-tree-search-clear"
                                    @click="viewMode === 'tree' ? clearSearch() : handleSessionSearchChange('')"
                                    type="button"
                                    aria-label="Ê∏ÖÈô§ÊêúÁ¥¢"
                                    title="Ê∏ÖÈô§ÊêúÁ¥¢ (ESC)"
                                >
                                    ‚úï
                                </button>
                                <!-- ËßÜÂõæÂàáÊç¢ÊåâÈíÆÔºàÈõÜÊàêÂú®ÊêúÁ¥¢Ê°ÜÂÜÖÔºâ -->
                                <div class="view-mode-toggle">
                                    <button 
                                        type="button"
                                        class="view-mode-btn"
                                        :class="{ 'active': viewMode === 'tree' }"
                                        @click="setViewMode('tree')"
                                        :disabled="loading"
                                        title="Ê†ëÂΩ¢ËßÜÂõæ"
                                        aria-label="ÂàáÊç¢Âà∞Ê†ëÂΩ¢ËßÜÂõæ">
                                        <i class="fas fa-sitemap" aria-hidden="true"></i>
                                    </button>
                                    <button 
                                        type="button"
                                        class="view-mode-btn"
                                        :class="{ 'active': viewMode === 'tags' }"
                                        @click="setViewMode('tags')"
                                        :disabled="loading"
                                        title="Ê†áÁ≠æËßÜÂõæ"
                                        aria-label="ÂàáÊç¢Âà∞Ê†áÁ≠æËßÜÂõæ">
                                        <i class="fas fa-tags" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Â∑•ÂÖ∑Ê†èÔºàÂ∑≤ÁßªËá≥‰ºöËØùÂàóË°®ÁªÑ‰ª∂ÂÜÖÈÉ®Ôºâ -->
                        
                    </div>
                    
                    <!-- Ê†ëÂΩ¢ËßÜÂõæÔºöÊòæÁ§∫Êñá‰ª∂Ê†ë -->
                    <file-tree 
                        v-show="viewMode === 'tree'"
                        :tree="fileTree" 
                        :selected-key="selectedKey" 
                        :expanded-folders="expandedFolders" 
                        :loading="loading" 
                        :error="errorMessage" 
                        :comments="comments"
                        :collapsed="sidebarCollapsed"
                        :search-query="searchQuery"
                        :batch-mode="batchMode"
                        :selected-keys="selectedKeys"
                        :view-mode="viewMode"
                        :selected-tags="(selectedSessionTags && Array.isArray(selectedSessionTags)) ? selectedSessionTags : []"
                        :tag-filter-reverse="tagFilterReverse || false"
                        :tag-filter-no-tags="tagFilterNoTags || false"
                        :tag-filter-expanded="tagFilterExpanded || false"
                        :tag-filter-search-keyword="tagFilterSearchKeyword || ''"
                        @file-select="handleFileSelect"  
                        @folder-toggle="handleFolderToggle"
                        @create-folder="handleCreateFolder"
                        @create-file="handleCreateFile"
                        @rename-item="handleRenameItem"
                        @delete-item="handleDeleteItem"
                        @create-session="handleCreateSession"
                        @toggle-collapse="toggleSidebar"
                        @search-change="handleSearchChange"
                        @toggle-batch-mode="toggleBatchMode"
                        @batch-select-file="toggleFileSelection"
                        @download-project="handleDownloadProjectVersion"
                        @upload-project="handleUploadProjectVersion"
                        @view-mode-change="setViewMode"
                        @tag-select="handleTagSelect"
                        @tag-clear="handleTagClear"
                        @tag-filter-reverse="handleTagFilterReverse"
                        @tag-filter-no-tags="handleTagFilterNoTags"
                        @tag-filter-expand="handleTagFilterExpand"
                        @tag-filter-search="handleTagFilterSearch"
                    ></file-tree>
                    
                    <!-- Ê†áÁ≠æËßÜÂõæÔºöÊòæÁ§∫‰ºöËØùÂàóË°® -->
                    <session-list 
                        v-show="viewMode === 'tags'"
                        :sessions="(sessions && Array.isArray(sessions)) ? sessions : []"
                        :loading="sessionLoading || false"
                        :error="sessionError || null"
                        :selected-tags="(selectedSessionTags && Array.isArray(selectedSessionTags)) ? selectedSessionTags : []"
                        :search-query="sessionSearchQuery || ''"
                        :tag-filter-reverse="tagFilterReverse || false"
                        :tag-filter-no-tags="tagFilterNoTags || false"
                        :tag-filter-expanded="tagFilterExpanded || false"
                        :tag-filter-visible-count="tagFilterVisibleCount || 8"
                        :tag-filter-search-keyword="tagFilterSearchKeyword || ''"
                        :session-batch-mode="sessionBatchMode || false"
                        :selected-session-keys="selectedSessionKeys || new Set()"
                        :is-all-sessions-selected="isAllSessionsSelected"
                        @session-select="handleSessionSelect"
                        @session-delete="handleSessionDelete"
                        @session-create="handleSessionCreate"
                        @session-favorite="handleSessionFavorite"
                        @session-edit="handleSessionEdit"
                        @session-tag="handleSessionTag"
                        @session-duplicate="handleSessionDuplicate"
                        @session-context="handleSessionContext"
                        @session-open-url="handleSessionOpenUrl"
                        @session-tree="handleSessionTree"
                        @session-batch-select="handleSessionBatchSelect"
                        @session-batch-select-all="handleToggleSelectAllSessions"
                        @session-batch-delete="handleBatchDeleteSessions"
                        @session-batch-cancel="toggleSessionBatchMode"
                        @toggle-batch-mode="toggleSessionBatchMode"
                        @session-import-file="handleSessionImportFile"
                        @session-export="handleSessionExport"
                        @tag-select="handleTagSelect"
                        @tag-clear="handleTagClear"
                        @search-change="handleSessionSearchChange"
                        @tag-filter-reverse="handleTagFilterReverse"
                        @tag-filter-no-tags="handleTagFilterNoTags"
                        @tag-filter-expand="handleTagFilterExpand"
                        @tag-filter-search="handleTagFilterSearch"
                        @toggle-collapse="handleSessionViewBack"
                    ></session-list>
                </div>
            </aside>
            
            
            <section class="aicr-code" :class="{ 'with-sidebar-collapsed': sidebarCollapsed, 'with-comments-collapsed': commentsCollapsed }" aria-label="‰ª£Á†ÅÂå∫">
                <code-view 
                    v-if="viewMode === 'tree'"
                    :file="currentFile" 
                    :loading="loading" 
                    :error="errorMessage"
                    :comments="currentComments"
                    @comment-delete="handleCommentDelete"
                    @comment-resolve="handleCommentResolve"
                    @comment-reopen="handleCommentReopen"
                    @reload-comments="handleReloadComments"
                ></code-view>

                <div v-if="viewMode === 'tags'" class="pet-chat-right-panel" aria-label="‰ºöËØùËÅäÂ§©Èù¢Êùø">
                    <div class="pet-chat-messages" id="pet-chat-messages" role="log" aria-live="polite">
                        <div v-if="activeSessionLoading" class="pet-chat-loading" role="status" aria-live="polite">
                            <div class="loading-spinner" aria-hidden="true"></div>
                            <div class="loading-text">Ê≠£Âú®Âä†ËΩΩ‰ºöËØù...</div>
                        </div>
                        <div v-else-if="activeSessionError" class="pet-chat-error" role="alert" aria-live="polite">
                            <div class="error-text">{{ activeSessionError }}</div>
                        </div>
                        <div v-else-if="!activeSession" class="pet-chat-empty" role="status">
                            <div class="pet-chat-empty-title">Êú™ÈÄâÊã©‰ºöËØù</div>
                            <div class="pet-chat-empty-subtitle">ËØ∑‰ªéÂ∑¶‰æß‰ºöËØùÂàóË°®ÈÄâÊã©‰∏Ä‰∏™‰ºöËØù</div>
                        </div>
                        <div v-else>
                            <div 
                                v-for="(m, idx) in sessionChatMessages(activeSession)" 
                                :key="`${m.timestamp || 0}_${idx}`"
                                class="pet-chat-message"
                                :class="m.type === 'pet' ? 'is-pet' : 'is-user'"
                            >
                                <div class="pet-chat-bubble">
                                    <img v-if="m.imageDataUrl" class="pet-chat-image" :src="m.imageDataUrl" alt="ÂõæÁâáÊ∂àÊÅØ" />
                                    <div v-if="m.content && String(m.content).trim()" class="pet-chat-content md-preview-body" v-html="renderSessionChatMarkdown(m.content)"></div>
                                    <div class="pet-chat-meta">
                                        <button
                                            v-if="m.content && String(m.content).trim()"
                                            type="button"
                                            class="pet-chat-meta-btn"
                                            @click="copySessionChatMessage(m.content)"
                                            aria-label="Â§çÂà∂Ê∂àÊÅØ"
                                            title="Â§çÂà∂"
                                        >Â§çÂà∂</button>
                                        <time class="pet-chat-time" :datetime="m.timestamp">{{ formatTime(m.timestamp) }}</time>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pet-chat-input-container chat-input-container">
                        <div class="pet-chat-toolbar chat-input-toolbar">
                            <div class="pet-chat-toolbar-left chat-input-btn-group">
                                <button type="button" class="pet-chat-btn chat-input-btn chat-input-text-btn" @click="openSessionContextEditor" title="È°µÈù¢‰∏ä‰∏ãÊñá" aria-label="È°µÈù¢‰∏ä‰∏ãÊñá">üìù È°µÈù¢‰∏ä‰∏ãÊñá</button>
                                <button type="button" class="pet-chat-btn chat-input-btn chat-input-text-btn" @click="openSessionFaq" title="Â∏∏ËßÅÈóÆÈ¢ò" aria-label="Â∏∏ËßÅÈóÆÈ¢ò">üí° Â∏∏ËßÅÈóÆÈ¢ò</button>
                                <button type="button" class="pet-chat-btn chat-input-btn chat-input-icon-btn" @click="openSessionSettings" title="AI ËÆæÁΩÆ" aria-label="AI ËÆæÁΩÆ">‚öôÔ∏è</button>
                            </div>
                            <div class="pet-chat-toolbar-right chat-input-btn-group">
                                <div class="context-switch-container" :class="{ active: sessionContextEnabled }" title="ÂºÄÂêØ/ÂÖ≥Èó≠È°µÈù¢‰∏ä‰∏ãÊñá">
                                    <span class="context-switch-label">È°µÈù¢‰∏ä‰∏ãÊñá</span>
                                    <label class="context-switch-wrapper" for="context-switch">
                                        <div class="context-switch-thumb"></div>
                                    </label>
                                    <input
                                        id="context-switch"
                                        class="context-switch-input"
                                        type="checkbox"
                                        :checked="sessionContextEnabled"
                                        @change="setSessionContextEnabled($event.target.checked)"
                                        aria-label="È°µÈù¢‰∏ä‰∏ãÊñáÂºÄÂÖ≥"
                                    />
                                </div>
                                <button
                                    type="button"
                                    class="chat-input-status-btn"
                                    :class="{ active: sessionChatSending }"
                                    :disabled="!sessionChatSending"
                                    @click="abortSessionChatRequest"
                                    :title="sessionChatSending ? 'ËØ∑Ê±ÇÁä∂ÊÄÅÔºöÁîüÊàê‰∏≠ÔºàÁÇπÂáªÂÅúÊ≠¢Ôºâ' : 'ËØ∑Ê±ÇÁä∂ÊÄÅÔºöÁ©∫Èó≤'"
                                    aria-label="ËØ∑Ê±ÇÁä∂ÊÄÅ"
                                >‚èπÔ∏è</button>
                                <button type="button" class="pet-chat-btn chat-input-clear-btn" @click="clearSessionContext" title="Ê∏ÖÈô§‰∏ä‰∏ãÊñá" aria-label="Ê∏ÖÈô§‰∏ä‰∏ãÊñá">üßπ Ê∏ÖÈô§‰∏ä‰∏ãÊñá</button>
                            </div>
                        </div>

                        <div class="chat-input-wrapper">
                            <textarea
                                id="pet-chat-input"
                                class="pet-chat-textarea chat-message-input"
                                :value="sessionChatInput"
                                @input="onSessionChatInput"
                                @keydown="onSessionChatKeydown"
                                placeholder="ËæìÂÖ•Ê∂àÊÅØ... (Enter ÂèëÈÄÅ, Shift+Enter Êç¢Ë°å)"
                                rows="2"
                                aria-label="‰ºöËØùËæìÂÖ•Ê°Ü"
                            ></textarea>
                        </div>
                    </div>

                    <div v-if="sessionContextEditorVisible" class="aicr-session-context-modal" role="dialog" aria-modal="true" aria-label="È°µÈù¢‰∏ä‰∏ãÊñáÁºñËæëÂô®">
                        <div class="aicr-session-context-modal-mask" @click="closeSessionContextEditor"></div>
                        <div class="aicr-session-context-modal-body">
                            <div class="aicr-session-context-modal-header">
                                <div class="aicr-session-context-modal-title">
                                    È°µÈù¢‰∏ä‰∏ãÊñá
                                    <span class="aicr-session-context-modal-subtitle">ÔºàMarkdownÔºâ</span>
                                </div>
                                <div class="aicr-session-context-modal-header-right">
                                <div class="aicr-session-context-mode-group" role="tablist" aria-label="‰∏ä‰∏ãÊñáËßÜÂõæÂàáÊç¢">
                                    <button
                                        type="button"
                                        class="aicr-session-context-mode-btn"
                                        :class="{ active: sessionContextMode === 'split' }"
                                        @click="setSessionContextMode('split')"
                                        role="tab"
                                        :aria-selected="sessionContextMode === 'split'"
                                        aria-label="Âπ∂Êéí"
                                    >Âπ∂Êéí</button>
                                    <button
                                        type="button"
                                        class="aicr-session-context-mode-btn"
                                        :class="{ active: sessionContextMode === 'edit' }"
                                        @click="setSessionContextMode('edit')"
                                        role="tab"
                                        :aria-selected="sessionContextMode === 'edit'"
                                        aria-label="‰ªÖÁºñËæë"
                                    >‰ªÖÁºñËæë</button>
                                    <button
                                        type="button"
                                        class="aicr-session-context-mode-btn"
                                        :class="{ active: sessionContextMode === 'preview' }"
                                        @click="setSessionContextMode('preview')"
                                        role="tab"
                                        :aria-selected="sessionContextMode === 'preview'"
                                        aria-label="‰ªÖÈ¢ÑËßà"
                                    >‰ªÖÈ¢ÑËßà</button>
                                </div>
                                <button type="button" class="aicr-session-context-toolbar-btn" @click="copySessionContextDraft" title="Â§çÂà∂ÂÜÖÂÆπ" aria-label="Â§çÂà∂ÂÜÖÂÆπ">Â§çÂà∂</button>
                                <button type="button" class="aicr-session-context-toolbar-btn" @click="optimizeSessionContextDraft" title="Êô∫ËÉΩ‰ºòÂåñ‰∏ä‰∏ãÊñáÂÜÖÂÆπ" aria-label="Êô∫ËÉΩ‰ºòÂåñ">‚ú® Êô∫ËÉΩ‰ºòÂåñ</button>
                                <button v-show="sessionContextUndoVisible" type="button" class="aicr-session-context-toolbar-btn" @click="undoOptimizeSessionContextDraft" title="Êí§ÈîÄ‰ºòÂåñ" aria-label="Êí§ÈîÄ‰ºòÂåñ">‚Ü∂ Êí§ÈîÄ</button>
                                <button type="button" class="aicr-session-context-toolbar-btn primary" @click="saveSessionContext" title="‰øùÂ≠ò‰øÆÊîπ" aria-label="‰øùÂ≠ò‰øÆÊîπ">‰øùÂ≠ò</button>
                                <button type="button" class="aicr-session-context-modal-close" @click="closeSessionContextEditor" aria-label="ÂÖ≥Èó≠">‚úï</button>
                                </div>
                            </div>
                            <div class="aicr-session-context-modal-content">
                                <div class="aicr-session-context-editor-body" :data-mode="sessionContextMode">
                                    <div v-if="sessionContextMode === 'split'" class="aicr-session-context-split">
                                        <textarea
                                            class="aicr-session-context-textarea"
                                            :value="sessionContextDraft"
                                            @input="setSessionContextDraft($event.target.value)"
                                            rows="10"
                                            aria-label="È°µÈù¢‰∏ä‰∏ãÊñáÂÜÖÂÆπ"
                                        ></textarea>
                                        <div
                                            class="aicr-session-context-preview md-preview-body"
                                            v-html="renderSessionChatMarkdown(sessionContextDraft)"
                                            aria-label="È°µÈù¢‰∏ä‰∏ãÊñáÈ¢ÑËßà"
                                        ></div>
                                    </div>
                                    <textarea
                                        v-else-if="sessionContextMode === 'edit'"
                                        class="aicr-session-context-textarea"
                                        :value="sessionContextDraft"
                                        @input="setSessionContextDraft($event.target.value)"
                                        rows="10"
                                        aria-label="È°µÈù¢‰∏ä‰∏ãÊñáÂÜÖÂÆπ"
                                    ></textarea>
                                    <div
                                        v-else
                                        class="aicr-session-context-preview md-preview-body"
                                        v-html="renderSessionChatMarkdown(sessionContextDraft)"
                                        aria-label="È°µÈù¢‰∏ä‰∏ãÊñáÈ¢ÑËßà"
                                    ></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <aside class="aicr-comments" aria-label="ËØÑËÆ∫Âå∫" v-show="viewMode === 'tree' && !commentsCollapsed" :style="{ width: commentsWidth + 'px' }">
                <div class="sidebar-scroll-container">
                    <comment-panel 
                        :comments="currentComments" 
                        :file="currentFile"
                        :view-mode="viewMode"
                        :new-comment="newComment" 
                        :loading="loading" 
                        :error="errorMessage" 
                        :collapsed="commentsCollapsed"
                        @comment-submit="handleCommentSubmit" 
                        @comment-input="handleCommentInput"
                        @comment-delete="handleCommentDelete"
                        @comment-resolve="handleCommentResolve"
                        @comment-reopen="handleCommentReopen"
                        @toggle-collapse="toggleComments"
                    ></comment-panel>
                </div>
            </aside>

            <!-- ËØÑËÆ∫Âå∫Êî∂Ëµ∑ÊåâÈíÆ (Â±ïÂºÄÊó∂ÊòæÁ§∫ÔºåË∑üÈöèËØÑËÆ∫Âå∫ÂÆΩÂ∫¶) -->
            <div 
                class="comments-toggle" 
                v-show="viewMode === 'tree' && !commentsCollapsed"
                @click="toggleComments"
                title="Êî∂Ëµ∑ËØÑËÆ∫Âå∫"
                :style="{ right: (commentsWidth - 14) + 'px', left: 'auto' }">
                <i class="fas fa-chevron-right"></i>
            </div>

            <!-- ËØÑËÆ∫Âå∫Êî∂Ëµ∑ÂêéÁöÑÂ±ïÂºÄÊääÊâã -->
            <button 
                type="button"
                class="comments-expand-handle" 
                v-show="viewMode === 'tree' && commentsCollapsed"
                @click="toggleComments"
                aria-label="Â±ïÂºÄËØÑËÆ∫Âå∫"
                title="Â±ïÂºÄËØÑËÆ∫Âå∫">
                <i class="fas fa-chevron-left" aria-hidden="true"></i>
            </button>
            
        </main>
    </div>

    <!-- ÂÖ®Â±ÄÂä†ËΩΩÊåáÁ§∫Âô® -->
    <section id="global-loading-indicator" class="loading-indicator" aria-hidden="true" aria-label="ÂÖ®Â±ÄÂä†ËΩΩ‰∏≠">
      <div class="loading-content">
          <div class="loading-spinner" role="status" aria-live="polite" aria-label="Ê≠£Âú®Âä†ËΩΩ"></div>
          <p class="loading-text" id="loading-text">Ê≠£Âú®Âä†ËΩΩ...</p>
      </div>
    </section>

    
    
    <!-- ËÑöÊú¨Ê†áÁ≠æÁßªÂà∞VueÂ∫îÁî®ÂÆπÂô®Â§ñÈÉ® -->
    <!-- Âü∫Á°ÄÈÖçÁΩÆÂíåÂ∑•ÂÖ∑ -->
    <script type="module" src="../../config.js"></script>
    <script type="module" src="../../utils/chartViewer.js"></script>
    
    <!-- Mermaid Áõ∏ÂÖ≥ËÑöÊú¨ÔºàÊåâ‰æùËµñÈ°∫Â∫èÂä†ËΩΩÔºâ -->
    <script type="module" src="../../utils/mermaid.js"></script>
    <script type="module" src="../../utils/mermaidDebug.js"></script>
    <script type="module" src="../../utils/mermaidRenderer.js"></script>
    
    <!-- Êèí‰ª∂ÁªÑ‰ª∂ -->
    <script type="module" src="../../views/aicr/components/fileTree/index.js"></script>
    <script type="module" src="../../views/aicr/components/codeView/index.js"></script>
    <script type="module" src="../../views/aicr/components/commentPanel/index.js"></script>
    <script type="module" src="../../views/aicr/components/sessionList/index.js"></script>
    
    <!-- ‰∏ªÂ∫îÁî®ÂÖ•Âè£ -->
    <script type="module" src="../../views/aicr/index.js"></script>
    
    <!-- ÊÄßËÉΩÁõëÊéßÔºàÊúÄÂêéÂä†ËΩΩÔºâ -->
    <script type="module" src="../../utils/performance.js"></script>
</body>
</html>
